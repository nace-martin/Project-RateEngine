import e from"node:http";import t from"node:https";import{getProxyAgent as r}from"./get-proxy-agent.js";function o(o,s,n){return new Promise((a,i)=>{let{protocol:u}=new URL(o),f=s?3e3:void 0,d=("https:"===u?t:e).request(o,{agent:r(),headers:{"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"}},e=>{if(200!==e.statusCode)return void i(Error(n||`Request failed: ${o} (status: ${e.statusCode})`));let t=[];e.on("data",e=>t.push(Buffer.from(e))),e.on("end",()=>a(Buffer.concat(t)))});f&&d.setTimeout(f,()=>{d.destroy(Error(`Request timed out after ${f}ms`))}),d.on("error",e=>i(e)),d.end()})}export{o as fetchResource};
